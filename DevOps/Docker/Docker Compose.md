## üìù YAML Configuration for Docker Compose
- **Docker Compose** uses YAML-formatted files to configure multi-container applications, making it easier to define and run applications with multiple services.
  
- **Tool**: Typically used with the CLI tool `docker-compose` for **local development and test automation**.  
> [!warning]  
> Docker Compose is **not suitable for production** environments due to its limited scalability features. Production setups should use Docker Swarm or Kubernetes.

---

## üìÑ Full Docker Compose Example with Explanations

```yaml
version: '3.8' # Define the Compose file version (use the latest version for compatibility)

services: # Define each container as a service
  my-service: # Example name for the service
    image: my-image:latest # The image to be used for this service
    command: some-command # (Optional) Override default container command
    environment: # (Optional) Environment variables for the container
      - ENV_VAR=value
      - DATABASE_URL=mysql://user:password@db:3306/mydb # Example of a database URL
    ports: # (Optional) Expose container ports to the host
      - "8080:80" # Map port 80 in the container to port 8080 on the host
      - "443:443" # Map port 443 for HTTPS
    volumes: # (Optional) Mount volumes for data persistence
      - my-volume:/path/in/container # Mount a named volume
      - ./local/path:/container/path # Bind mount a local path to a container path
    networks: # (Optional) Specify networks for container communication
      - my-network

  service2: # Additional services can be defined here
    image: another-image:latest
    ports:
      - "3000:3000" # Map host port 3000 to container port 3000
    depends_on: # Specify service dependencies for startup order
      - my-service # Ensures service2 waits for my-service to start
    environment:
      - API_KEY=123456789

volumes: # Define named volumes for persistent storage
  my-volume:
    driver: local # Specify the volume driver if needed (default is local)

networks: # Define networks for container isolation and communication
  my-network:
    driver: bridge # Bridge is the default driver; useful for local container networking
```

---

### üõ† Detailed Configuration Breakdown

#### üîå Ports
- **`ports`**: Expose ports from the container to the host. Specify them as `"host_port:container_port"`.
  - Example: `"8080:80"` maps port 80 inside the container to port 8080 on the host.

#### üß¨ Environment Variables
- **`environment`**: Define environment variables accessible within the container. This is useful for setting configuration options, such as API keys, database URLs, or secrets.
  - Example: `DATABASE_URL=mysql://user:password@db:3306/mydb` sets a connection string for a MySQL database.

#### üìÅ Volumes
- **`volumes`**: Volumes persist data generated by and used by Docker containers. There are two types:
  - **Named volumes** (`my-volume:/path/in/container`) are managed by Docker.
  - **Bind mounts** (`./local/path:/container/path`) link a host directory or file to a container path.
  
#### üîó Networks
- **`networks`**: Define custom networks to control communication between containers.
  - Use `bridge` for local networks or `overlay` for Docker Swarm.

#### ‚õì Dependencies
- **`depends_on`**: Define the order in which services start. This ensures that dependencies like databases are ready before the dependent service.

> [!note]  
> **Docker Compose V2**: Use `docker compose up` instead of `docker-compose up` for the latest version integrated into the Docker CLI.

---

### üìú Common Docker Compose Commands
- **`docker compose up`**: Sets up volumes, networks, and containers as specified in the `docker-compose.yml` file and starts the containers.
  
- **`docker compose down`**: Stops all containers and removes associated volumes and networks, cleaning up the setup.

---

### ‚öôÔ∏è Additional Docker Compose File Options

#### ü©∫ Health Checks
Docker Compose allows health checks to determine the health status of a container. This can be used to monitor services and control dependencies between services.

Example:
```yaml
services:
  my-service:
    image: my-image:latest
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost"]
      interval: 1m30s # Time between checks
      timeout: 10s # Time to wait before considering the check failed
      retries: 3 # Number of attempts before marking as unhealthy
```

- **Explanation**: This checks if the service is accessible at `http://localhost` every 1 minute and 30 seconds, with a 10-second timeout, and retries up to 3 times if the service is unresponsive.

#### ‚è∞ Restart Policies
Define conditions under which a service should restart.

Example:
```yaml
services:
  my-service:
    image: my-image:latest
    restart: on-failure # Other options: no, always, unless-stopped
```

- **Explanation**: This configures the service to restart only if it fails, useful for resilient deployments.

#### üõ† Resource Limits
Set memory and CPU limits for containers.

Example:
```yaml
services:
  my-service:
    image: my-image:latest
    deploy:
      resources:
        limits:
          cpus: "0.5" # 50% CPU limit
          memory: "512M" # 512MB memory limit
```

- **Explanation**: Useful for managing resources, especially in constrained environments or testing performance limits.

#### üåê Networks
Create custom networks to isolate groups of services.

Example:
```yaml
services:
  my-service:
    image: my-image:latest
    networks:
      - my-network

networks:
  my-network:
    driver: bridge
```

- **Explanation**: Custom networks allow for isolated service communication within specified groups and help control traffic flow.

---

### üìå Additional Docker Compose CLI Commands
- **`docker compose logs -f`**: Follow logs of all containers in the composition, useful for debugging and monitoring.

- **`docker compose stop`**: Stop running services without removing them.

- **`docker compose ps`**: List the status of containers within a composition.

- **`docker compose config`**: Validate and view the expanded `docker-compose.yml` file.
- `docker compose down -rmi`: stops & remove those containers, `rmi` to remove those build images

With these configurations and commands, Docker Compose offers a flexible and quick way to orchestrate containers locally for development and testing